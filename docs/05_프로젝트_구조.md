## 프로젝트 구조
> **아래 구조는 프로젝트의 핵심 파일/디렉토리만 발췌하여 나타낸 것입니다. 실제 전체 파일은 더 많으며, 주요 파일 위주로 작성하였습니다.**


### 프론트엔드 (React + TypeScript)
```
frontend/src/
├── pages/           # 주요 페이지 컴포넌트
│   ├── HomePage.tsx        # 대시보드: 내 정보, 멤버십
│   ├── LoginPage.tsx       # 로그인
│   ├── RegisterPage.tsx    # 회원가입
│   ├── MembershipPage.tsx  # 멤버십 구매
│   ├── ChatPage.tsx        # AI 채팅 (음성/STT/TTS + 텍스트 입력, 나가기 버튼 포함)
│   └── AdminPage.tsx       # 관리자(유저/멤버십 관리)
├── services/        # API 서비스 모듈
│   ├── authService.ts       # 인증(JWT)
│   ├── chatService.ts       # 채팅
│   ├── membershipService.ts # 멤버십
│   └── userService.ts       # 사용자 정보
└── App.tsx         # 앱 라우팅/초기화
```

### 백엔드 (Ruby on Rails)

```
backend/
├── app/controllers/api/v1/
│   ├── auth_controller.rb         # 인증(JWT)
│   ├── users_controller.rb        # 유저 관리(조회/부여/회수)
│   ├── chat_controller.rb         # AI 채팅
│   └── memberships_controller.rb  # 멤버십 관리
├── app/models/
│   ├── user.rb
│   └── membership.rb
├── lib/
│   ├── gemini_client.rb        # Gemini API 연동
│   └── system_prompts.rb       # 시스템 프롬프트/컨텍스트
└── config/routes.rb            # RESTful API 라우팅
```

## 주요 기능

### 1. 사용자 인증
- JWT 기반 인증
- 회원가입, 로그인/로그아웃, 토큰 갱신 및 만료
- 서비스 전체 보호 및 유저 상태 확인

### 2. 멤버십 관리
- 베이직/프리미엄/쿠폰 등급 지원
- 기능별 접근권 제어
- 쿠폰(대화횟수) 시스템

### 3. AI 채팅 시스템
- Google Gemini 연동(실시간, 스트리밍 제공)
- 주제 맥락 유지, 영어회화 튜터
- 음성(STT/TTS) 통합

### 4. 음성 기능
- Web Speech API(프론트 STT/TTS)
- 실시간 음성 인식 및 합성
- 오남용/쿨다운 방지

### 5. 관리자 기능
- 유저 목록, 멤버십 상태/부여/회수
- 멤버십(생성/삭제), 통계

## API 엔드포인트

### 인증
- `POST /api/v1/auth/register` - 회원가입
- `POST /api/v1/auth/login` - 로그인
- `POST /api/v1/auth/logout` - 로그아웃
- `GET /api/v1/auth/me` - 현재 사용자 정보
- `GET /api/v1/auth/validate` - 토큰 유효성 검증

### 사용자 관리
- `GET /api/v1/users` - 사용자 목록 (관리자)
- `GET /api/v1/users/:id` - 사용자 정보
- `POST /api/v1/users/:id/assign_membership` - 멤버십 부여
- `DELETE /api/v1/users/:id/remove_membership` - 멤버십 회수
- `POST /api/v1/users/:id/purchase_membership` - 멤버십 구매

### 채팅
- `POST /api/v1/chat/start` - 채팅 세션 시작
- `POST /api/v1/chat/message` - AI 메시지 전송
- `POST /api/v1/chat/message_stream` - 스트리밍 AI 응답

### 멤버십
- `GET /api/v1/memberships` - 멤버십 목록
- `POST /api/v1/memberships` - 멤버십 생성 (관리자)
- `DELETE /api/v1/memberships/:id` - 멤버십 삭제 (관리자)

## 보안 및 최적화

### 오남용 방지
- 쿨다운 시스템 (3초)
- 연속 요청 제한 (1분에 10회)
- 최소 녹음 시간 (0.5초)
- 최대 녹음 시간 (5분)
- 메시지 길이 제한 (1000자)

### 성능 최적화
- 스트리밍 응답으로 빠른 AI 응답
- 시스템 프롬프트 중앙화
- 불필요한 리소스 제거

